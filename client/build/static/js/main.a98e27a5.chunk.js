(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{345:function(e,t,a){e.exports=a(742)},350:function(e,t,a){},411:function(e,t,a){},491:function(e,t){},493:function(e,t){},525:function(e,t){},526:function(e,t){},584:function(e,t,a){},611:function(e,t){},621:function(e,t,a){},622:function(e,t,a){},740:function(e,t,a){},742:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(5),i=a.n(r),c=(a(350),a(342)),s=a(72),l=(a(351),a(324)),u=a(208),m="SET_ROOM_DATA",d="SET_USER_DATA";function p(e){return{type:m,payload:e}}var h={userData:{},roomData:{}};var f=Object(s.c)({pageInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:var a=t.payload;return Object(u.a)({},e,{userData:a});case m:var o=t.payload;return Object(u.a)({},e,{roomData:o});default:return e}}}),g=[l.a];g=s.a.apply(void 0,Object(c.a)(g));var v=Object(s.d)(f,g),b=(a(209),a(147)),y=a(745),k=a(340),E=a(326),j=a(110),O=a.n(j),D=a(206),C=a(24),w=a(25),R=a(27),S=a(26),I=a(28),M=a(36),T=a(746),N=a(744),F=a(747),A=a(149),V=a.n(A);a(408);V.a.initializeApp({apiKey:"AIzaSyDUMCwUCgkZCf4Dec5QQByW2pk3qdTTnmk",authDomain:"code-pair-ec2c8.firebaseapp.com",databaseURL:"https://code-pair-ec2c8.firebaseio.com",projectId:"code-pair-ec2c8",storageBucket:"code-pair-ec2c8.appspot.com",messagingSenderId:"930776554345"});var L=V.a.auth(),U=new V.a.auth.GithubAuthProvider,x=(a(66),a(16)),P=(a(411),a(57)),J=a.n(P),B=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).state={data:void 0},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.a.get("/api/snippets").then(function(t){e.setState({data:t.data.result})})}},{key:"render",value:function(){return this.state.data?n.a.createElement("div",{className:"landingpage-wrapper"},n.a.createElement(x.a,{style:{width:620},onClick:this.props.onLoginClick},"Enter")):n.a.createElement("div",null)}}]),t}(o.Component),W=(a(237),a(93)),z=(a(743),a(341)),_=(a(480),a(337)),q=(a(482),a(75)),G=a(111),H=(a(238),a(146)),Q=(a(239),a(94)),$=(a(125),a(52)),K=a(330),Y=a.n(K),Z=function(e){return J.a.post("/api/codefile/",e)},X=$.a.Group,ee=Q.a.Option,te=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).setLanguage=function(e){a.setState({language:e})},a.setRoom=function(){var e={language:a.state.language,roomName:a.state.room};a.props.setRoomData(e),a.props.setModalVisible(!1),a.props.setInRoom(!0)},a.handleUploadFile=function(e){var t=new FormData;t.append("file",e.target.files[0]),Z(t).then(function(e){a.props.setCodeFromFile(e.data.result)})},a.state={language:"python",room:Y.a.generate({length:12,charset:"alphabetic"})},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(H.a,{title:"Create Room",visible:this.props.modalVisible,onOk:function(){return e.setRoom()},onCancel:function(){return e.props.setModalVisible(!1)}},n.a.createElement($.a,{addonBefore:"room",style:{width:"100%"},defaultValue:this.state.room,disabled:!0}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(X,{compact:!0},n.a.createElement(Q.a,{style:{width:"50%"},defaultValue:this.state.language,onChange:this.setLanguage},["python","javascript"].map(function(e,t){return n.a.createElement(ee,{key:t,value:e},e)})),n.a.createElement($.a,{type:"file",onChange:this.handleUploadFile})))}}]),t}(o.Component);var ae={setRoomData:p},oe=Object(M.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},ae)(te),ne=(a(584),function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).state={},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"rightsection"},n.a.createElement("code",null,this.props.result))}}]),t}(o.Component)),re=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).setRoom=function(e){a.setState({room:e.target.value})},a.getRoom=function(){var e={roomName:a.state.room};a.props.setRoomData(e),a.props.setModalVisible(!1),a.props.setInRoom(!0)},a.state={room:""},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(H.a,{title:"Join Room",visible:this.props.modalVisible,onOk:function(){return e.getRoom()},onCancel:function(){return e.props.setModalVisible(!1)}},n.a.createElement($.a,{addonBefore:"room",style:{width:"100%"},value:this.state.room,onChange:this.setRoom}))}}]),t}(o.Component);var ie={setRoomData:p},ce=Object(M.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},ie)(re),se=a(332),le=(a(189),a(333)),ue=a.n(le),me=a(334),de=a.n(me),pe=(a(614),a(616),a(617),a(618),a(619),a(620),a(621),Q.a.Option),he=$.a.Group,fe=de()(),ge=function(e){function t(e,a){var o;return Object(C.a)(this,t),(o=Object(R.a)(this,Object(S.a)(t).call(this,e,a))).onChange=function(e){o.setState({code:e},function(){return console.log(o.state.code)}),fe.emit("coding event",{code:e,room:o.state.room})},o.setTheme=function(e){o.setState({theme:e})},o.updateCodeFromSockets=function(e){o.setState({code:e})},o.updateUsersAndCodeInState=function(e){o.setState({code:e.code,language:e.language})},o.sendUsersAndCode=function(){fe.emit("send users and code",{room:o.state.room,code:o.state.code,language:o.state.language})},o.downloadFile=function(){var e=document.createElement("a"),t=new Blob([o.state.code],{type:"text/plain"});e.href=URL.createObjectURL(t),"javascript"===o.state.language?e.download="file.js":"python"===o.state.language&&(e.download="file.py"),document.body.appendChild(e),e.click()},o.state={language:"javascript",theme:"tomorrow",code:"",room:"",users:[]},fe.on("receive code",function(e){return o.updateCodeFromSockets(e.code)}),fe.on("load users and code",function(){return o.sendUsersAndCode()}),fe.on("receive users and code",function(e){return o.updateUsersAndCodeInState(e)}),o}return Object(I.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){this.setState({code:this.props.codeFromFile})}},{key:"componentDidMount",value:function(){var e=this;this.setState({room:this.props.roomData.roomName,language:this.props.roomData.language},function(){return fe.emit("room",{room:e.state.room})})}},{key:"componentWillUnmount",value:function(){fe.emit("leave room",{room:this.state.room})}},{key:"render",value:function(){var e=this,t=this.state,a=t.language,o=t.theme,r=t.code;return n.a.createElement("div",{className:"editor"},n.a.createElement("div",{className:"option"},n.a.createElement(he,{compact:!0},n.a.createElement($.a,{style:{width:"75px"},defaultValue:"theme",disabled:!0}),n.a.createElement(Q.a,{style:{width:"125px"},defaultValue:this.state.theme,onChange:this.setTheme},["tomorrow","solarized_dark","monokai","github"].map(function(e){return n.a.createElement(pe,{key:e,value:e},e)}))),n.a.createElement(x.a,{onClick:function(){return e.downloadFile()}},"download code"),n.a.createElement(x.a,{onClick:function(){return e.props.run(e.state.code,e.state.language)}},"run")),n.a.createElement(ue.a,{mode:a,theme:o,name:"myeditor",onChange:this.onChange,value:r,editorProps:{$blockScrolling:!0},setOptions:{showLineNumbers:!0,tabSize:2,showPrintMargin:!1}}))}}]),t}(o.Component);var ve=Object(M.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},{})(ge),be=function(e){return J.a.post("/api/code/python",{code:e})},ye=a(335),ke=a.n(ye),Ee=(a(622),a(623),a(336)),je=a.n(Ee),Oe=(a(740),function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this))).joinRoom=function(){if(a.state.roomName.trim()){console.log("Joining room '"+a.state.roomName+"'...");var e={name:a.state.roomName};a.state.previewTracks&&(e.tracks=a.state.previewTracks),je.a.connect(a.state.token,e).then(a.roomJoined,function(e){console.log("Could not connect to Twilio: "+e.message)})}else a.setState({roomNameErr:!0})},a.roomJoined=function(e){console.log("Joined as '"+a.state.identity+"'"),a.setState({activeRoom:e,localMediaAvailable:!0,hasJoinedRoom:!0});var t=a.refs.localMedia;t.querySelector("video")||a.attachParticipantTracks(e.localParticipant,t),t.querySelector("video")||a.attachParticipantTracks(e.localParticipant,t),e.participants.forEach(function(e){console.log("Already in Room: '"+e.identity+"'");var t=a.refs.remoteMedia;a.attachParticipantTracks(e,t)}),e.on("participantConnected",function(e){console.log("Joining: '"+e.identity+"'")}),e.on("trackAdded",function(e,t){console.log(t.identity+" added track: "+e.kind);var o=a.refs.remoteMedia;a.attachTracks([e],o)}),e.on("trackRemoved",function(e,t){a.detachTracks([e])}),e.on("participantDisconnected",function(e){console.log("Participant '"+e.identity+"' left the room"),a.detachParticipantTracks(e)}),e.on("disconnected",function(){a.state.previewTracks&&a.state.previewTracks.forEach(function(e){e.stop()}),a.detachParticipantTracks(e.localParticipant),e.participants.forEach(a.detachParticipantTracks),a.state.activeRoom=null,a.setState({hasJoinedRoom:!1,localMediaAvailable:!1})})},a.detachTracks=function(e){e.forEach(function(e){e.detach().forEach(function(e){e.remove()})})},a.detachParticipantTracks=function(e){var t=Array.from(e.tracks.values());a.detachTracks(t)},a.leaveRoom=function(){a.state.activeRoom.disconnect(),a.setState({hasJoinedRoom:!1,localMediaAvailable:!1})},a.state={identity:null,roomName:"",roomNameErr:!1,previewTracks:null,localMediaAvailable:!1,hasJoinedRoom:!1,activeRoom:null},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.a.post("/api/twilio/token",{user:"".concat(this.props.userData.name,"-").concat(this.props.userData.id)}).then(function(t){var a=t.data,o=a.identity,n=a.token;e.setState({identity:o,token:n})}),this.setState({roomName:this.props.roomData.roomName}),console.log(this.state.roomName)}},{key:"attachTracks",value:function(e,t){e.forEach(function(e){t.appendChild(e.attach())})}},{key:"attachParticipantTracks",value:function(e,t){var a=Array.from(e.tracks.values());this.attachTracks(a,t)}},{key:"render",value:function(){var e=this.state.localMediaAvailable?n.a.createElement("div",{className:"wrapper"},n.a.createElement("div",{ref:"localMedia"}),n.a.createElement("div",{ref:"remoteMedia",id:"remote-media"})):"",t=this.state.hasJoinedRoom?n.a.createElement(x.a,{type:"primary",shape:"round",size:"small",onClick:this.leaveRoom},"Leave Video Chat"):n.a.createElement(x.a,{type:"primary",shape:"round",size:"small",onClick:this.joinRoom},"Join Video Chat");return n.a.createElement("div",{className:"wrapper"},t,e)}}]),t}(o.Component));var De={setRoomData:p},Ce=Object(M.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},De)(Oe),we=q.a.Header,Re=q.a.Footer,Se=q.a.Sider,Ie=q.a.Content,Me=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).toggle=function(){a.setState({collapsed:!a.state.collapsed})},a.onCollapse=function(e){console.log(e),a.setState({collapsed:e})},a.createRoomVisible=function(e){a.setState({createroommodal:e})},a.joinRoomVisible=function(e){a.setState({joinroommodal:e})},a.setInRoom=function(e){a.setState({Inroom:e})},a.confirm=function(e){a.props.onLogoutClick()},a.handleNewUserMessage=function(e){console.log("New message incoming! ".concat(e)),"hi"===e||"hey"===e?Object(G.addResponseMessage)("hello"):"bye"===e?Object(G.addResponseMessage)("goodbye"):Object(G.addResponseMessage)("i dont understand")},a.run=function(e,t){"python"===t?be(e).then(function(e){a.setState({result:e.data.result})}):a.setState({result:"language not supported"})},a.setCodeFromFile=function(e){a.setState({codeFromFile:e})},a.state={collapsed:!1,Inroom:!1,createroommodal:!1,joinroommodal:!1,result:void 0,codeFromFile:""},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.userData!==this.props.userData&&console.log(this.props.userData)}},{key:"render",value:function(){var e=this;return ke.a.isEmpty(this.props.userData)?n.a.createElement("div",null):n.a.createElement("div",{className:"dashboard"},n.a.createElement(q.a,{style:{minHeight:"100vh"}},n.a.createElement(Se,{trigger:null,collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},n.a.createElement("div",{className:"logo"},n.a.createElement(_.a,{size:"large",src:this.props.userData.photo})),n.a.createElement("div",{style:{textAlign:"center"}},this.state.Inroom&&n.a.createElement(b.a,null," ",this.props.roomData.roomName)),n.a.createElement(z.a,{title:"Are you sure you want to log out?",placement:"right",onConfirm:this.confirm,okText:"Yes",cancelText:"No"},n.a.createElement(x.a,{type:"primary",style:{width:"50%",position:"absolute",bottom:"50px",left:"25%"}},"log out"))),n.a.createElement(q.a,null,n.a.createElement(we,{style:{background:"#fff",padding:0}},this.state.Inroom&&n.a.createElement(Ce,null)),n.a.createElement(Ie,{style:{margin:"0 16px"}},this.state.Inroom?n.a.createElement(se.a,{style:{background:"#fff",minHeight:"100%"}},n.a.createElement(ve,{run:this.run,codeFromFile:this.state.codeFromFile}),this.state.result?n.a.createElement(ne,{result:this.state.result}):n.a.createElement("div",null)):n.a.createElement("div",{className:"croom"},n.a.createElement(W.a,{description:n.a.createElement("span",null,"no workspace :("),style:{marginBottom:"10px"}}),n.a.createElement("div",null,n.a.createElement(x.a,{type:"primary",onClick:function(){return e.createRoomVisible(!0)}},"Create Room")," "," / "," ",n.a.createElement(x.a,{type:"primary",onClick:function(){return e.joinRoomVisible(!0)}},"Join Room")))),n.a.createElement(Re,{style:{textAlign:"center"}},"akin develops \xa92019 Created by Akin Shonibare"))),n.a.createElement(G.Widget,{handleNewUserMessage:this.handleNewUserMessage,title:"chat room",subtitle:""}),n.a.createElement(oe,{modalVisible:this.state.createroommodal,setModalVisible:this.createRoomVisible,setInRoom:this.setInRoom,setCodeFromFile:this.setCodeFromFile}),n.a.createElement(ce,{modalVisible:this.state.joinroommodal,setModalVisible:this.joinRoomVisible,setInRoom:this.setInRoom}))}}]),t}(o.Component);var Te={setRoomData:p},Ne=Object(M.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},Te)(Me),Fe=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).onLoginClick=Object(D.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({authLoading:!0}),e.prev=1,e.next=4,L.signInWithPopup(U);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0.message||"error authenticating user."),a.setState({authLoading:!1});case 10:case"end":return e.stop()}},e,this,[[1,6]])})),a.onLogoutClick=Object(D.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.signOut();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0.message||"error signing user out.");case 8:case"end":return e.stop()}},e,this,[[0,5]])})),a.state={authLoading:!0},a}return Object(I.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authObserver=L.onAuthStateChanged(function(t){if(t){var a={};a.name=t.providerData[0].displayName,a.email=t.providerData[0].email,a.id=t.providerData[0].uid,a.photo=t.providerData[0].photoURL,e.props.setUserData(a)}t?e.props.history.push("/"):e.props.history.push("/login"),e.setState({authLoading:!1})})}},{key:"componentWillUnmount",value:function(){this.authObserver()}},{key:"render",value:function(){var e=this,t=this.state.authLoading;return n.a.createElement(T.a,null,n.a.createElement(N.a,{exact:!0,path:"/",render:function(t){return n.a.createElement(Ne,Object.assign({onLogoutClick:e.onLogoutClick},t))}}),n.a.createElement(N.a,{exact:!0,path:"/login",render:function(a){return n.a.createElement(B,Object.assign({loading:t,onLoginClick:e.onLoginClick},a))}}))}}]),t}(o.Component);var Ae={setUserData:function(e){return{type:d,payload:e}}},Ve=Object(F.a)(Object(M.b)(function(e){return{userData:e.pageData,teamData:e.pageData}},Ae)(Fe)),Le=n.a.createElement(k.a,null,n.a.createElement(y.a,null,E.isMobile?n.a.createElement("div",{style:{width:"100%",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"}},n.a.createElement(b.a,{color:"red"},"code pair unavailable on mobile, open on laptop/desktop")):n.a.createElement(Ve,null)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ue=n.a.createElement(M.a,{store:v},Le);i.a.render(Ue,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[345,1,2]]]);
//# sourceMappingURL=main.a98e27a5.chunk.js.map