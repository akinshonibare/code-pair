(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{346:function(e,t,a){e.exports=a(746)},351:function(e,t,a){},412:function(e,t,a){},494:function(e,t){},496:function(e,t){},528:function(e,t){},529:function(e,t){},576:function(e,t,a){},588:function(e,t,a){},615:function(e,t){},625:function(e,t,a){},626:function(e,t,a){},744:function(e,t,a){},746:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),r=a(5),s=a.n(r),i=(a(351),a(95)),c=a(72),l=(a(352),a(326)),u=a(210),m="SET_ROOM_DATA",p="SET_USER_DATA";function d(e){return{type:m,payload:e}}var h={userData:{},roomData:{}};var f=Object(c.c)({pageInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:var a=t.payload;return Object(u.a)({},e,{userData:a});case m:var o=t.payload;return Object(u.a)({},e,{roomData:o});default:return e}}}),g=[l.a];g=c.a.apply(void 0,Object(i.a)(g));var v=Object(c.d)(f,g),b=(a(211),a(149)),y=a(749),k=a(342),E=a(328),j=a(111),O=a.n(j),D=a(207),C=a(24),w=a(25),R=a(27),S=a(26),T=a(28),I=a(36),U=a(750),N=a(748),M=a(751),F=a(150),A=a.n(F);a(409);A.a.initializeApp({apiKey:"AIzaSyDUMCwUCgkZCf4Dec5QQByW2pk3qdTTnmk",authDomain:"code-pair-ec2c8.firebaseapp.com",databaseURL:"https://code-pair-ec2c8.firebaseio.com",projectId:"code-pair-ec2c8",storageBucket:"code-pair-ec2c8.appspot.com",messagingSenderId:"930776554345"});var V=A.a.auth(),x=new A.a.auth.GithubAuthProvider,L=(a(52),a(16)),P=(a(412),a(57)),J=a.n(P),B=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).state={data:void 0},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.a.get("/api/snippets").then(function(t){e.setState({data:t.data.result})})}},{key:"render",value:function(){return this.state.data?n.a.createElement("div",{className:"landingpage-wrapper"},n.a.createElement(L.a,{style:{width:620},onClick:this.props.onLoginClick},"Enter")):n.a.createElement("div",null)}}]),t}(o.Component),W=(a(239),a(93)),z=(a(747),a(343)),_=(a(481),a(209)),q=(a(483),a(339)),G=(a(485),a(75)),H=a(112),Q=(a(240),a(147)),$=(a(241),a(94)),K=(a(126),a(59)),Y=a(332),Z=a.n(Y),X=function(e){return J.a.post("/api/codefile/",e)},ee=(a(576),K.a.Group),te=$.a.Option,ae=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).setLanguage=function(e){a.setState({language:e})},a.setRoom=function(){var e={language:a.state.language,roomName:a.state.room};a.props.setRoomData(e),a.props.setModalVisible(!1),a.props.setInRoom(!0)},a.handleUploadFile=function(e){var t=new FormData;t.append("file",e.target.files[0]),X(t).then(function(e){a.props.setCodeFromFile(e.data.result)})},a.state={language:"python",room:Z.a.generate({length:12,charset:"alphabetic"})},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(Q.a,{title:"Create Room",visible:this.props.modalVisible,onOk:function(){return e.setRoom()},onCancel:function(){return e.props.setModalVisible(!1)},className:"createroom"},n.a.createElement(K.a,{addonBefore:"room",style:{width:"100%"},defaultValue:this.state.room,disabled:!0}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(ee,{compact:!0},n.a.createElement($.a,{style:{width:"50%"},defaultValue:this.state.language,onChange:this.setLanguage},["python","javascript"].map(function(e,t){return n.a.createElement(te,{key:t,value:e},e)})),n.a.createElement(L.a,{style:{width:"50%"}},"Upload Starter Code File",n.a.createElement("input",{type:"file",name:"file",id:"code-file",className:"inputfile",onChange:this.handleUploadFile}))))}}]),t}(o.Component);var oe={setRoomData:d},ne=Object(I.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},oe)(ae),re=(a(588),function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).state={},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"rightsection"},n.a.createElement("code",null,this.props.result))}}]),t}(o.Component)),se=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).setRoom=function(e){a.setState({room:e.target.value})},a.getRoom=function(){var e={roomName:a.state.room};a.props.setRoomData(e),a.props.setModalVisible(!1),a.props.setInRoom(!0)},a.state={room:""},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(Q.a,{title:"Join Room",visible:this.props.modalVisible,onOk:function(){return e.getRoom()},onCancel:function(){return e.props.setModalVisible(!1)}},n.a.createElement(K.a,{addonBefore:"room",style:{width:"100%"},value:this.state.room,onChange:this.setRoom}))}}]),t}(o.Component);var ie={setRoomData:d},ce=Object(I.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},ie)(se),le=a(334),ue=(a(190),a(335)),me=a.n(ue),pe=a(336),de=a.n(pe),he=(a(618),a(620),a(621),a(622),a(623),a(624),a(625),$.a.Option),fe=K.a.Group,ge=de()(),ve=function(e){function t(e,a){var o;return Object(C.a)(this,t),(o=Object(R.a)(this,Object(S.a)(t).call(this,e,a))).onChange=function(e){o.setState({code:e}),o.props.setCurrentlyTyping("".concat(o.props.userData.name,"-").concat(o.props.userData.id)),ge.emit("coding event",{code:e,room:o.state.room,currentlyTyping:"".concat(o.props.userData.name,"-").concat(o.props.userData.id)})},o.setTheme=function(e){o.setState({theme:e})},o.joinUser=function(e){var t=[].concat(Object(i.a)(o.props.users),[e]),a=Array.from(new Set(t)).filter(function(e){return e.length>1});o.props.setUsers(a)},o.updateCodeFromSockets=function(e){console.log(e),o.setState({code:e.code}),o.props.setCurrentlyTyping(e.currentlyTyping)},o.updateUsersAndCodeInState=function(e){o.setState({code:e.code,language:e.language});var t=[].concat(Object(i.a)(e.users),["".concat(o.props.userData.name,"-").concat(o.props.userData.id)]);o.props.setUsers(t)},o.sendUsersAndCode=function(){ge.emit("send users and code",{room:o.state.room,code:o.state.code,language:o.state.language,users:o.props.users})},o.downloadFile=function(){var e=document.createElement("a"),t=new Blob([o.state.code],{type:"text/plain"});e.href=URL.createObjectURL(t),"javascript"===o.state.language?e.download="file.js":"python"===o.state.language&&(e.download="file.py"),document.body.appendChild(e),e.click()},o.state={language:"javascript",theme:"tomorrow",code:"",room:"",currentlyTyping:null},ge.on("receive code",function(e){return o.updateCodeFromSockets(e)}),ge.on("load users and code",function(){return o.sendUsersAndCode()}),ge.on("receive users and code",function(e){return o.updateUsersAndCodeInState(e)}),ge.on("new user join",function(e){return o.joinUser(e)}),ge.on("user left room",function(e){return o.removeUser(e)}),o}return Object(T.a)(t,e),Object(w.a)(t,[{key:"componentWillMount",value:function(){this.props.codeFromFile&&this.setState({code:this.props.codeFromFile})}},{key:"removeUser",value:function(e){var t=Object.assign([],this.props.users),a=this.props.users.findIndex(function(t){return t==e.user});t.splice(a,1),this.props.setUsers(t)}},{key:"componentDidMount",value:function(){var e=this,t=[].concat(Object(i.a)(this.props.users),["".concat(this.props.userData.name,"-").concat(this.props.userData.id)]),a="".concat(this.props.userData.name,"-").concat(this.props.userData.id);this.props.setUsers(t),this.setState({room:this.props.roomData.roomName,language:this.props.roomData.language},function(){return ge.emit("room",{room:e.state.room,user:a})})}},{key:"componentWillUnmount",value:function(){ge.emit("leave room",{room:this.state.room})}},{key:"render",value:function(){var e=this,t=this.state,a=t.language,o=t.theme,r=t.code;return n.a.createElement("div",{className:"editor"},n.a.createElement("div",{className:"option"},n.a.createElement(fe,{compact:!0},n.a.createElement(K.a,{style:{width:"75px"},defaultValue:"theme",disabled:!0}),n.a.createElement($.a,{style:{width:"125px"},defaultValue:this.state.theme,onChange:this.setTheme},["tomorrow","solarized_dark","monokai","github"].map(function(e){return n.a.createElement(he,{key:e,value:e},e)}))),n.a.createElement(L.a,{onClick:function(){return e.downloadFile()}},"download code"),n.a.createElement(L.a,{onClick:function(){return e.props.run(e.state.code,e.state.language)}},"run")),n.a.createElement(me.a,{mode:a,theme:o,name:"myeditor",onChange:this.onChange,value:r,editorProps:{$blockScrolling:!0},setOptions:{showLineNumbers:!0,tabSize:2,showPrintMargin:!1}}))}}]),t}(o.Component);var be=Object(I.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},{})(ve),ye=function(e){return J.a.post("/api/code/python",{code:e})},ke=a(337),Ee=a.n(ke),je=(a(626),a(627),a(338)),Oe=a.n(je),De=(a(744),function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this))).joinRoom=function(){if(a.state.roomName.trim()){console.log("Joining room '"+a.state.roomName+"'...");var e={name:a.state.roomName};a.state.previewTracks&&(e.tracks=a.state.previewTracks),Oe.a.connect(a.state.token,e).then(a.roomJoined,function(e){console.log("Could not connect to Twilio: "+e.message)})}else a.setState({roomNameErr:!0})},a.roomJoined=function(e){console.log("Joined as '"+a.state.identity+"'"),a.setState({activeRoom:e,localMediaAvailable:!0,hasJoinedRoom:!0});var t=a.refs.localMedia;t.querySelector("video")||a.attachParticipantTracks(e.localParticipant,t),t.querySelector("video")||a.attachParticipantTracks(e.localParticipant,t),e.participants.forEach(function(e){console.log("Already in Room: '"+e.identity+"'");var t=a.refs.remoteMedia;a.attachParticipantTracks(e,t)}),e.on("participantConnected",function(e){console.log("Joining: '"+e.identity+"'")}),e.on("trackAdded",function(e,t){console.log(t.identity+" added track: "+e.kind);var o=a.refs.remoteMedia;a.attachTracks([e],o)}),e.on("trackRemoved",function(e,t){a.detachTracks([e])}),e.on("participantDisconnected",function(e){console.log("Participant '"+e.identity+"' left the room"),a.detachParticipantTracks(e)}),e.on("disconnected",function(){a.state.previewTracks&&a.state.previewTracks.forEach(function(e){e.stop()}),a.detachParticipantTracks(e.localParticipant),e.participants.forEach(a.detachParticipantTracks),a.state.activeRoom=null,a.setState({hasJoinedRoom:!1,localMediaAvailable:!1})})},a.detachTracks=function(e){e.forEach(function(e){e.detach().forEach(function(e){e.remove()})})},a.detachParticipantTracks=function(e){var t=Array.from(e.tracks.values());a.detachTracks(t)},a.leaveRoom=function(){a.state.activeRoom.disconnect(),a.setState({hasJoinedRoom:!1,localMediaAvailable:!1})},a.state={identity:null,roomName:"",roomNameErr:!1,previewTracks:null,localMediaAvailable:!1,hasJoinedRoom:!1,activeRoom:null},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;J.a.post("/api/twilio/token",{user:"".concat(this.props.userData.name,"-").concat(this.props.userData.id)}).then(function(t){var a=t.data,o=a.identity,n=a.token;e.setState({identity:o,token:n})}),this.setState({roomName:this.props.roomData.roomName}),console.log(this.state.roomName)}},{key:"attachTracks",value:function(e,t){e.forEach(function(e){t.appendChild(e.attach())})}},{key:"attachParticipantTracks",value:function(e,t){var a=Array.from(e.tracks.values());this.attachTracks(a,t)}},{key:"render",value:function(){var e=this.state.localMediaAvailable?n.a.createElement("div",{className:"wrapper"},n.a.createElement("div",{ref:"localMedia"}),n.a.createElement("div",{ref:"remoteMedia",id:"remote-media"})):"",t=this.state.hasJoinedRoom?n.a.createElement(L.a,{type:"primary",shape:"round",size:"small",onClick:this.leaveRoom},"Leave Video Chat"):n.a.createElement(L.a,{type:"primary",shape:"round",size:"small",onClick:this.joinRoom},"Join Video Chat");return n.a.createElement("div",{className:"wrapper"},t,e)}}]),t}(o.Component));var Ce={setRoomData:d},we=Object(I.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},Ce)(De),Re=G.a.Header,Se=G.a.Footer,Te=G.a.Sider,Ie=G.a.Content,Ue=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).toggle=function(){a.setState({collapsed:!a.state.collapsed})},a.setUsers=function(e){a.setState({users:e})},a.setCurrentlyTyping=function(e){a.setState({currentlyTyping:e})},a.onCollapse=function(e){console.log(e),a.setState({collapsed:e})},a.createRoomVisible=function(e){a.setState({createroommodal:e})},a.joinRoomVisible=function(e){a.setState({joinroommodal:e})},a.setInRoom=function(e){a.setState({Inroom:e})},a.confirm=function(e){a.props.onLogoutClick()},a.handleNewUserMessage=function(e){console.log("New message incoming! ".concat(e)),"hi"===e||"hey"===e?Object(H.addResponseMessage)("hello"):"bye"===e?Object(H.addResponseMessage)("goodbye"):Object(H.addResponseMessage)("i dont understand")},a.run=function(e,t){"python"===t?ye(e).then(function(e){a.setState({result:e.data.result})}):a.setState({result:"language not supported"})},a.setCodeFromFile=function(e){a.setState({codeFromFile:e})},a.state={collapsed:!1,Inroom:!1,createroommodal:!1,joinroommodal:!1,result:void 0,codeFromFile:void 0,users:[],currentlyTyping:null},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"componentDidUpdate",value:function(e,t){e.userData!==this.props.userData&&console.log(this.props.userData)}},{key:"render",value:function(){var e=this;return Ee.a.isEmpty(this.props.userData)?n.a.createElement("div",null):n.a.createElement("div",{className:"dashboard"},n.a.createElement(G.a,{style:{minHeight:"100vh"}},n.a.createElement(Te,{trigger:null,collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},n.a.createElement("div",{className:"logo"},n.a.createElement(q.a,{size:"large",src:this.props.userData.photo})),n.a.createElement("div",{style:{textAlign:"center"}},this.state.Inroom&&n.a.createElement(b.a,null," ",this.props.roomData.roomName),n.a.createElement("div",{className:"users"},n.a.createElement(_.a,null,this.state.users.map(function(t){return n.a.createElement(_.a.Item,{color:e.state.currentlyTyping===t?"green":"blue",key:t},t.split("-")[0])})))),n.a.createElement(z.a,{title:"Are you sure you want to log out?",placement:"right",onConfirm:this.confirm,okText:"Yes",cancelText:"No"},n.a.createElement(L.a,{type:"primary",style:{width:"50%",position:"absolute",bottom:"50px",left:"25%"}},"log out"))),n.a.createElement(G.a,null,n.a.createElement(Re,{style:{background:"#fff",padding:0}},this.state.Inroom&&n.a.createElement(we,null)),n.a.createElement(Ie,{style:{margin:"0 16px"}},this.state.Inroom?n.a.createElement(le.a,{style:{background:"#fff",minHeight:"100%"}},n.a.createElement(be,{run:this.run,codeFromFile:this.state.codeFromFile,users:this.state.users,setUsers:this.setUsers,currentlyTyping:this.state.currentlyTyping,setCurrentlyTyping:this.setCurrentlyTyping}),this.state.result?n.a.createElement(re,{result:this.state.result}):n.a.createElement("div",null)):n.a.createElement("div",{className:"croom"},n.a.createElement(W.a,{description:n.a.createElement("span",null,"no workspace :("),style:{marginBottom:"10px"}}),n.a.createElement("div",null,n.a.createElement(L.a,{type:"primary",onClick:function(){return e.createRoomVisible(!0)}},"Create Room")," "," / "," ",n.a.createElement(L.a,{type:"primary",onClick:function(){return e.joinRoomVisible(!0)}},"Join Room")))),n.a.createElement(Se,{style:{textAlign:"center"}},"akin develops \xa92019 Created by Akin Shonibare"))),n.a.createElement(H.Widget,{handleNewUserMessage:this.handleNewUserMessage,title:"chat room",subtitle:""}),n.a.createElement(ne,{modalVisible:this.state.createroommodal,setModalVisible:this.createRoomVisible,setInRoom:this.setInRoom,setCodeFromFile:this.setCodeFromFile}),n.a.createElement(ce,{modalVisible:this.state.joinroommodal,setModalVisible:this.joinRoomVisible,setInRoom:this.setInRoom}))}}]),t}(o.Component);var Ne={setRoomData:d},Me=Object(I.b)(function(e){return{userData:e.pageInfo.userData,roomData:e.pageInfo.roomData}},Ne)(Ue),Fe=function(e){function t(e){var a;return Object(C.a)(this,t),(a=Object(R.a)(this,Object(S.a)(t).call(this,e))).onLoginClick=Object(D.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({authLoading:!0}),e.prev=1,e.next=4,V.signInWithPopup(x);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0.message||"error authenticating user."),a.setState({authLoading:!1});case 10:case"end":return e.stop()}},e,this,[[1,6]])})),a.onLogoutClick=Object(D.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.signOut();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0.message||"error signing user out.");case 8:case"end":return e.stop()}},e,this,[[0,5]])})),a.state={authLoading:!0},a}return Object(T.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.authObserver=V.onAuthStateChanged(function(t){if(t){var a={};a.name=t.providerData[0].displayName,a.email=t.providerData[0].email,a.id=t.providerData[0].uid,a.photo=t.providerData[0].photoURL,e.props.setUserData(a)}t?e.props.history.push("/"):e.props.history.push("/login"),e.setState({authLoading:!1})})}},{key:"componentWillUnmount",value:function(){this.authObserver()}},{key:"render",value:function(){var e=this,t=this.state.authLoading;return n.a.createElement(U.a,null,n.a.createElement(N.a,{exact:!0,path:"/",render:function(t){return n.a.createElement(Me,Object.assign({onLogoutClick:e.onLogoutClick},t))}}),n.a.createElement(N.a,{exact:!0,path:"/login",render:function(a){return n.a.createElement(B,Object.assign({loading:t,onLoginClick:e.onLoginClick},a))}}))}}]),t}(o.Component);var Ae={setUserData:function(e){return{type:p,payload:e}}},Ve=Object(M.a)(Object(I.b)(function(e){return{userData:e.pageData,teamData:e.pageData}},Ae)(Fe)),xe=n.a.createElement(k.a,null,n.a.createElement(y.a,null,E.isMobile?n.a.createElement("div",{style:{width:"100%",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"}},n.a.createElement(b.a,{color:"red"},"code pair unavailable on mobile, open on laptop/desktop")):n.a.createElement(Ve,null)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Le=n.a.createElement(I.a,{store:v},xe);s.a.render(Le,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[346,1,2]]]);
//# sourceMappingURL=main.bb5d225a.chunk.js.map